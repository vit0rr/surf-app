[{"type":"js","data":"(function () {\n\n/* Imports */\nvar Meteor = Package.meteor.Meteor;\nvar global = Package.meteor.global;\nvar meteorEnv = Package.meteor.meteorEnv;\nvar ECMAScript = Package.ecmascript.ECMAScript;\nvar meteorInstall = Package.modules.meteorInstall;\nvar Promise = Package.promise.Promise;\n\n/* Package-scope variables */\nvar Boilerplate;\n\nvar require = meteorInstall({\"node_modules\":{\"meteor\":{\"boilerplate-generator\":{\"generator.js\":function module(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                 //\n// packages/boilerplate-generator/generator.js                                                                     //\n//                                                                                                                 //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                   //\nlet _objectSpread;\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default(v) {\n    _objectSpread = v;\n  }\n}, 0);\nmodule.export({\n  Boilerplate: () => Boilerplate\n});\nlet readFile;\nmodule.link(\"fs\", {\n  readFile(v) {\n    readFile = v;\n  }\n}, 0);\nlet createStream;\nmodule.link(\"combined-stream2\", {\n  create(v) {\n    createStream = v;\n  }\n}, 1);\nlet WebBrowserTemplate;\nmodule.link(\"./template-web.browser\", {\n  default(v) {\n    WebBrowserTemplate = v;\n  }\n}, 2);\nlet WebCordovaTemplate;\nmodule.link(\"./template-web.cordova\", {\n  default(v) {\n    WebCordovaTemplate = v;\n  }\n}, 3);\n// Copied from webapp_server\nconst readUtf8FileSync = filename => Meteor.wrapAsync(readFile)(filename, 'utf8');\nconst identity = value => value;\nfunction appendToStream(chunk, stream) {\n  if (typeof chunk === \"string\") {\n    stream.append(Buffer.from(chunk, \"utf8\"));\n  } else if (Buffer.isBuffer(chunk) || typeof chunk.read === \"function\") {\n    stream.append(chunk);\n  }\n}\nlet shouldWarnAboutToHTMLDeprecation = !Meteor.isProduction;\nclass Boilerplate {\n  constructor(arch, manifest) {\n    let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    const {\n      headTemplate,\n      closeTemplate\n    } = getTemplate(arch);\n    this.headTemplate = headTemplate;\n    this.closeTemplate = closeTemplate;\n    this.baseData = null;\n    this._generateBoilerplateFromManifest(manifest, options);\n  }\n  toHTML(extraData) {\n    if (shouldWarnAboutToHTMLDeprecation) {\n      shouldWarnAboutToHTMLDeprecation = false;\n      console.error(\"The Boilerplate#toHTML method has been deprecated. \" + \"Please use Boilerplate#toHTMLStream instead.\");\n      console.trace();\n    }\n\n    // Calling .await() requires a Fiber.\n    return this.toHTMLAsync(extraData).await();\n  }\n\n  // Returns a Promise that resolves to a string of HTML.\n  toHTMLAsync(extraData) {\n    return new Promise((resolve, reject) => {\n      const stream = this.toHTMLStream(extraData);\n      const chunks = [];\n      stream.on(\"data\", chunk => chunks.push(chunk));\n      stream.on(\"end\", () => {\n        resolve(Buffer.concat(chunks).toString(\"utf8\"));\n      });\n      stream.on(\"error\", reject);\n    });\n  }\n\n  // The 'extraData' argument can be used to extend 'self.baseData'. Its\n  // purpose is to allow you to specify data that you might not know at\n  // the time that you construct the Boilerplate object. (e.g. it is used\n  // by 'webapp' to specify data that is only known at request-time).\n  // this returns a stream\n  toHTMLStream(extraData) {\n    if (!this.baseData || !this.headTemplate || !this.closeTemplate) {\n      throw new Error('Boilerplate did not instantiate correctly.');\n    }\n    const data = _objectSpread(_objectSpread({}, this.baseData), extraData);\n    const start = \"<!DOCTYPE html>\\n\" + this.headTemplate(data);\n    const {\n      body,\n      dynamicBody\n    } = data;\n    const end = this.closeTemplate(data);\n    const response = createStream();\n    appendToStream(start, response);\n    if (body) {\n      appendToStream(body, response);\n    }\n    if (dynamicBody) {\n      appendToStream(dynamicBody, response);\n    }\n    appendToStream(end, response);\n    return response;\n  }\n\n  // XXX Exported to allow client-side only changes to rebuild the boilerplate\n  // without requiring a full server restart.\n  // Produces an HTML string with given manifest and boilerplateSource.\n  // Optionally takes urlMapper in case urls from manifest need to be prefixed\n  // or rewritten.\n  // Optionally takes pathMapper for resolving relative file system paths.\n  // Optionally allows to override fields of the data context.\n  _generateBoilerplateFromManifest(manifest) {\n    let {\n      urlMapper = identity,\n      pathMapper = identity,\n      baseDataExtension,\n      inline\n    } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const boilerplateBaseData = _objectSpread({\n      css: [],\n      js: [],\n      head: '',\n      body: '',\n      meteorManifest: JSON.stringify(manifest)\n    }, baseDataExtension);\n    manifest.forEach(item => {\n      const urlPath = urlMapper(item.url);\n      const itemObj = {\n        url: urlPath\n      };\n      if (inline) {\n        itemObj.scriptContent = readUtf8FileSync(pathMapper(item.path));\n        itemObj.inline = true;\n      } else if (item.sri) {\n        itemObj.sri = item.sri;\n      }\n      if (item.type === 'css' && item.where === 'client') {\n        boilerplateBaseData.css.push(itemObj);\n      }\n      if (item.type === 'js' && item.where === 'client' &&\n      // Dynamic JS modules should not be loaded eagerly in the\n      // initial HTML of the app.\n      !item.path.startsWith('dynamic/')) {\n        boilerplateBaseData.js.push(itemObj);\n      }\n      if (item.type === 'head') {\n        boilerplateBaseData.head = readUtf8FileSync(pathMapper(item.path));\n      }\n      if (item.type === 'body') {\n        boilerplateBaseData.body = readUtf8FileSync(pathMapper(item.path));\n      }\n    });\n    this.baseData = boilerplateBaseData;\n  }\n}\n;\n\n// Returns a template function that, when called, produces the boilerplate\n// html as a string.\nfunction getTemplate(arch) {\n  const prefix = arch.split(\".\", 2).join(\".\");\n  if (prefix === \"web.browser\") {\n    return WebBrowserTemplate;\n  }\n  if (prefix === \"web.cordova\") {\n    return WebCordovaTemplate;\n  }\n  throw new Error(\"Unsupported arch: \" + arch);\n}\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template-web.browser.js\":function module(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                 //\n// packages/boilerplate-generator/template-web.browser.js                                                          //\n//                                                                                                                 //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                   //\nmodule.export({\n  headTemplate: () => headTemplate,\n  closeTemplate: () => closeTemplate\n});\nlet template;\nmodule.link(\"./template\", {\n  default(v) {\n    template = v;\n  }\n}, 0);\nconst sri = (sri, mode) => sri && mode ? \" integrity=\\\"sha512-\".concat(sri, \"\\\" crossorigin=\\\"\").concat(mode, \"\\\"\") : '';\nconst headTemplate = _ref => {\n  let {\n    css,\n    htmlAttributes,\n    bundledJsCssUrlRewriteHook,\n    sriMode,\n    head,\n    dynamicHead\n  } = _ref;\n  var headSections = head.split(/<meteor-bundled-css[^<>]*>/, 2);\n  var cssBundle = [...(css || []).map(file => template('  <link rel=\"stylesheet\" type=\"text/css\" class=\"__meteor-css__\" href=\"<%- href %>\"<%= sri %>>')({\n    href: bundledJsCssUrlRewriteHook(file.url),\n    sri: sri(file.sri, sriMode)\n  }))].join('\\n');\n  return ['<html' + Object.keys(htmlAttributes || {}).map(key => template(' <%= attrName %>=\"<%- attrValue %>\"')({\n    attrName: key,\n    attrValue: htmlAttributes[key]\n  })).join('') + '>', '<head>', headSections.length === 1 ? [cssBundle, headSections[0]].join('\\n') : [headSections[0], cssBundle, headSections[1]].join('\\n'), dynamicHead, '</head>', '<body>'].join('\\n');\n};\nconst closeTemplate = _ref2 => {\n  let {\n    meteorRuntimeConfig,\n    meteorRuntimeHash,\n    rootUrlPathPrefix,\n    inlineScriptsAllowed,\n    js,\n    additionalStaticJs,\n    bundledJsCssUrlRewriteHook,\n    sriMode\n  } = _ref2;\n  return ['', inlineScriptsAllowed ? template('  <script type=\"text/javascript\">__meteor_runtime_config__ = JSON.parse(decodeURIComponent(<%= conf %>))</script>')({\n    conf: meteorRuntimeConfig\n  }) : template('  <script type=\"text/javascript\" src=\"<%- src %>/meteor_runtime_config.js?hash=<%- hash %>\"></script>')({\n    src: rootUrlPathPrefix,\n    hash: meteorRuntimeHash\n  }), '', ...(js || []).map(file => template('  <script type=\"text/javascript\" src=\"<%- src %>\"<%= sri %>></script>')({\n    src: bundledJsCssUrlRewriteHook(file.url),\n    sri: sri(file.sri, sriMode)\n  })), ...(additionalStaticJs || []).map(_ref3 => {\n    let {\n      contents,\n      pathname\n    } = _ref3;\n    return inlineScriptsAllowed ? template('  <script><%= contents %></script>')({\n      contents\n    }) : template('  <script type=\"text/javascript\" src=\"<%- src %>\"></script>')({\n      src: rootUrlPathPrefix + pathname\n    });\n  }), '', '', '</body>', '</html>'].join('\\n');\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template-web.cordova.js\":function module(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                 //\n// packages/boilerplate-generator/template-web.cordova.js                                                          //\n//                                                                                                                 //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                   //\nmodule.export({\n  headTemplate: () => headTemplate,\n  closeTemplate: () => closeTemplate\n});\nlet template;\nmodule.link(\"./template\", {\n  default(v) {\n    template = v;\n  }\n}, 0);\nconst headTemplate = _ref => {\n  let {\n    meteorRuntimeConfig,\n    rootUrlPathPrefix,\n    inlineScriptsAllowed,\n    css,\n    js,\n    additionalStaticJs,\n    htmlAttributes,\n    bundledJsCssUrlRewriteHook,\n    head,\n    dynamicHead\n  } = _ref;\n  var headSections = head.split(/<meteor-bundled-css[^<>]*>/, 2);\n  var cssBundle = [\n  // We are explicitly not using bundledJsCssUrlRewriteHook: in cordova we serve assets up directly from disk, so rewriting the URL does not make sense\n  ...(css || []).map(file => template('  <link rel=\"stylesheet\" type=\"text/css\" class=\"__meteor-css__\" href=\"<%- href %>\">')({\n    href: file.url\n  }))].join('\\n');\n  return ['<html>', '<head>', '  <meta charset=\"utf-8\">', '  <meta name=\"format-detection\" content=\"telephone=no\">', '  <meta name=\"viewport\" content=\"user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, viewport-fit=cover\">', '  <meta name=\"msapplication-tap-highlight\" content=\"no\">', '  <meta http-equiv=\"Content-Security-Policy\" content=\"default-src * android-webview-video-poster: gap: data: blob: \\'unsafe-inline\\' \\'unsafe-eval\\' ws: wss:;\">', headSections.length === 1 ? [cssBundle, headSections[0]].join('\\n') : [headSections[0], cssBundle, headSections[1]].join('\\n'), '  <script type=\"text/javascript\">', template('    __meteor_runtime_config__ = JSON.parse(decodeURIComponent(<%= conf %>));')({\n    conf: meteorRuntimeConfig\n  }), '    if (/Android/i.test(navigator.userAgent)) {',\n  // When Android app is emulated, it cannot connect to localhost,\n  // instead it should connect to 10.0.2.2\n  // (unless we\\'re using an http proxy; then it works!)\n  '      if (!__meteor_runtime_config__.httpProxyPort) {', '        __meteor_runtime_config__.ROOT_URL = (__meteor_runtime_config__.ROOT_URL || \\'\\').replace(/localhost/i, \\'10.0.2.2\\');', '        __meteor_runtime_config__.DDP_DEFAULT_CONNECTION_URL = (__meteor_runtime_config__.DDP_DEFAULT_CONNECTION_URL || \\'\\').replace(/localhost/i, \\'10.0.2.2\\');', '      }', '    }', '  </script>', '', '  <script type=\"text/javascript\" src=\"/cordova.js\"></script>', ...(js || []).map(file => template('  <script type=\"text/javascript\" src=\"<%- src %>\"></script>')({\n    src: file.url\n  })), ...(additionalStaticJs || []).map(_ref2 => {\n    let {\n      contents,\n      pathname\n    } = _ref2;\n    return inlineScriptsAllowed ? template('  <script><%= contents %></script>')({\n      contents\n    }) : template('  <script type=\"text/javascript\" src=\"<%- src %>\"></script>')({\n      src: rootUrlPathPrefix + pathname\n    });\n  }), '', '</head>', '', '<body>'].join('\\n');\n};\nfunction closeTemplate() {\n  return \"</body>\\n</html>\";\n}\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.js\":function module(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                 //\n// packages/boilerplate-generator/template.js                                                                      //\n//                                                                                                                 //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                   //\nmodule.export({\n  default: () => template\n});\nlet lodashTemplate;\nmodule.link(\"lodash.template\", {\n  default(v) {\n    lodashTemplate = v;\n  }\n}, 0);\nfunction template(text) {\n  return lodashTemplate(text, null, {\n    evaluate: /<%([\\s\\S]+?)%>/g,\n    interpolate: /<%=([\\s\\S]+?)%>/g,\n    escape: /<%-([\\s\\S]+?)%>/g\n  });\n}\n;\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"node_modules\":{\"combined-stream2\":{\"package.json\":function module(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                 //\n// node_modules/meteor/boilerplate-generator/node_modules/combined-stream2/package.json                            //\n//                                                                                                                 //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                   //\nmodule.exports = {\n  \"name\": \"combined-stream2\",\n  \"version\": \"1.1.2\",\n  \"main\": \"index.js\"\n};\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function module(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                 //\n// node_modules/meteor/boilerplate-generator/node_modules/combined-stream2/index.js                                //\n//                                                                                                                 //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                   //\nmodule.useNode();\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"lodash.template\":{\"package.json\":function module(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                 //\n// node_modules/meteor/boilerplate-generator/node_modules/lodash.template/package.json                             //\n//                                                                                                                 //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                   //\nmodule.exports = {\n  \"name\": \"lodash.template\",\n  \"version\": \"4.5.0\"\n};\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function module(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                 //\n// node_modules/meteor/boilerplate-generator/node_modules/lodash.template/index.js                                 //\n//                                                                                                                 //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                   //\nmodule.useNode();\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}}}}}}},{\n  \"extensions\": [\n    \".js\",\n    \".json\"\n  ]\n});\n\nvar exports = require(\"/node_modules/meteor/boilerplate-generator/generator.js\");\n\n/* Exports */\nPackage._define(\"boilerplate-generator\", exports, {\n  Boilerplate: Boilerplate\n});\n\n})();\n","servePath":"/packages/boilerplate-generator.js","sourceMap":{"version":3,"sources":["packages/boilerplate-generator/generator.js","packages/boilerplate-generator/template-web.browser.js","packages/boilerplate-generator/template-web.cordova.js","packages/boilerplate-generator/template.js"],"names":["_objectSpread","module","link","default","v","export","Boilerplate","readFile","createStream","create","WebBrowserTemplate","WebCordovaTemplate","readUtf8FileSync","filename","Meteor","wrapAsync","identity","value","appendToStream","chunk","stream","append","Buffer","from","isBuffer","read","shouldWarnAboutToHTMLDeprecation","isProduction","constructor","arch","manifest","options","arguments","length","undefined","headTemplate","closeTemplate","getTemplate","baseData","_generateBoilerplateFromManifest","toHTML","extraData","console","error","trace","toHTMLAsync","await","Promise","resolve","reject","toHTMLStream","chunks","on","push","concat","toString","Error","data","start","body","dynamicBody","end","response","urlMapper","pathMapper","baseDataExtension","inline","boilerplateBaseData","css","js","head","meteorManifest","JSON","stringify","forEach","item","urlPath","url","itemObj","scriptContent","path","sri","type","where","startsWith","prefix","split","join","template","mode","_ref","htmlAttributes","bundledJsCssUrlRewriteHook","sriMode","dynamicHead","headSections","cssBundle","map","file","href","Object","keys","key","attrName","attrValue","_ref2","meteorRuntimeConfig","meteorRuntimeHash","rootUrlPathPrefix","inlineScriptsAllowed","additionalStaticJs","conf","src","hash","_ref3","contents","pathname","lodashTemplate","text","evaluate","interpolate","escape"],"mappings":"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","file":"/packages/boilerplate-generator.js","sourcesContent":["import { readFile } from 'fs';\nimport { create as createStream } from \"combined-stream2\";\n\nimport WebBrowserTemplate from './template-web.browser';\nimport WebCordovaTemplate from './template-web.cordova';\n\n// Copied from webapp_server\nconst readUtf8FileSync = filename => Meteor.wrapAsync(readFile)(filename, 'utf8');\n\nconst identity = value => value;\n\nfunction appendToStream(chunk, stream) {\n  if (typeof chunk === \"string\") {\n    stream.append(Buffer.from(chunk, \"utf8\"));\n  } else if (Buffer.isBuffer(chunk) ||\n             typeof chunk.read === \"function\") {\n    stream.append(chunk);\n  }\n}\n\nlet shouldWarnAboutToHTMLDeprecation = ! Meteor.isProduction;\n\nexport class Boilerplate {\n  constructor(arch, manifest, options = {}) {\n    const { headTemplate, closeTemplate } = getTemplate(arch);\n    this.headTemplate = headTemplate;\n    this.closeTemplate = closeTemplate;\n    this.baseData = null;\n\n    this._generateBoilerplateFromManifest(\n      manifest,\n      options\n    );\n  }\n\n  toHTML(extraData) {\n    if (shouldWarnAboutToHTMLDeprecation) {\n      shouldWarnAboutToHTMLDeprecation = false;\n      console.error(\n        \"The Boilerplate#toHTML method has been deprecated. \" +\n          \"Please use Boilerplate#toHTMLStream instead.\"\n      );\n      console.trace();\n    }\n\n    // Calling .await() requires a Fiber.\n    return this.toHTMLAsync(extraData).await();\n  }\n\n  // Returns a Promise that resolves to a string of HTML.\n  toHTMLAsync(extraData) {\n    return new Promise((resolve, reject) => {\n      const stream = this.toHTMLStream(extraData);\n      const chunks = [];\n      stream.on(\"data\", chunk => chunks.push(chunk));\n      stream.on(\"end\", () => {\n        resolve(Buffer.concat(chunks).toString(\"utf8\"));\n      });\n      stream.on(\"error\", reject);\n    });\n  }\n\n  // The 'extraData' argument can be used to extend 'self.baseData'. Its\n  // purpose is to allow you to specify data that you might not know at\n  // the time that you construct the Boilerplate object. (e.g. it is used\n  // by 'webapp' to specify data that is only known at request-time).\n  // this returns a stream\n  toHTMLStream(extraData) {\n    if (!this.baseData || !this.headTemplate || !this.closeTemplate) {\n      throw new Error('Boilerplate did not instantiate correctly.');\n    }\n\n    const data = {...this.baseData, ...extraData};\n    const start = \"<!DOCTYPE html>\\n\" + this.headTemplate(data);\n\n    const { body, dynamicBody } = data;\n\n    const end = this.closeTemplate(data);\n    const response = createStream();\n\n    appendToStream(start, response);\n\n    if (body) {\n      appendToStream(body, response);\n    }\n\n    if (dynamicBody) {\n      appendToStream(dynamicBody, response);\n    }\n\n    appendToStream(end, response);\n\n    return response;\n  }\n\n  // XXX Exported to allow client-side only changes to rebuild the boilerplate\n  // without requiring a full server restart.\n  // Produces an HTML string with given manifest and boilerplateSource.\n  // Optionally takes urlMapper in case urls from manifest need to be prefixed\n  // or rewritten.\n  // Optionally takes pathMapper for resolving relative file system paths.\n  // Optionally allows to override fields of the data context.\n  _generateBoilerplateFromManifest(manifest, {\n    urlMapper = identity,\n    pathMapper = identity,\n    baseDataExtension,\n    inline,\n  } = {}) {\n\n    const boilerplateBaseData = {\n      css: [],\n      js: [],\n      head: '',\n      body: '',\n      meteorManifest: JSON.stringify(manifest),\n      ...baseDataExtension,\n    };\n\n    manifest.forEach(item => {\n      const urlPath = urlMapper(item.url);\n      const itemObj = { url: urlPath };\n\n      if (inline) {\n        itemObj.scriptContent = readUtf8FileSync(\n          pathMapper(item.path));\n        itemObj.inline = true;\n      } else if (item.sri) {\n        itemObj.sri = item.sri;\n      }\n\n      if (item.type === 'css' && item.where === 'client') {\n        boilerplateBaseData.css.push(itemObj);\n      }\n\n      if (item.type === 'js' && item.where === 'client' &&\n        // Dynamic JS modules should not be loaded eagerly in the\n        // initial HTML of the app.\n        !item.path.startsWith('dynamic/')) {\n        boilerplateBaseData.js.push(itemObj);\n      }\n\n      if (item.type === 'head') {\n        boilerplateBaseData.head =\n          readUtf8FileSync(pathMapper(item.path));\n      }\n\n      if (item.type === 'body') {\n        boilerplateBaseData.body =\n          readUtf8FileSync(pathMapper(item.path));\n      }\n    });\n\n    this.baseData = boilerplateBaseData;\n  }\n};\n\n// Returns a template function that, when called, produces the boilerplate\n// html as a string.\nfunction getTemplate(arch) {\n  const prefix = arch.split(\".\", 2).join(\".\");\n\n  if (prefix === \"web.browser\") {\n    return WebBrowserTemplate;\n  }\n\n  if (prefix === \"web.cordova\") {\n    return WebCordovaTemplate;\n  }\n\n  throw new Error(\"Unsupported arch: \" + arch);\n}\n","import template from './template';\n\nconst sri = (sri, mode) =>\n  (sri && mode) ? ` integrity=\"sha512-${sri}\" crossorigin=\"${mode}\"` : '';\n\nexport const headTemplate = ({\n  css,\n  htmlAttributes,\n  bundledJsCssUrlRewriteHook,\n  sriMode,\n  head,\n  dynamicHead,\n}) => {\n  var headSections = head.split(/<meteor-bundled-css[^<>]*>/, 2);\n  var cssBundle = [...(css || []).map(file =>\n    template('  <link rel=\"stylesheet\" type=\"text/css\" class=\"__meteor-css__\" href=\"<%- href %>\"<%= sri %>>')({\n      href: bundledJsCssUrlRewriteHook(file.url),\n      sri: sri(file.sri, sriMode),\n    })\n  )].join('\\n');\n\n  return [\n    '<html' + Object.keys(htmlAttributes || {}).map(\n      key => template(' <%= attrName %>=\"<%- attrValue %>\"')({\n        attrName: key,\n        attrValue: htmlAttributes[key],\n      })\n    ).join('') + '>',\n\n    '<head>',\n\n    (headSections.length === 1)\n      ? [cssBundle, headSections[0]].join('\\n')\n      : [headSections[0], cssBundle, headSections[1]].join('\\n'),\n\n    dynamicHead,\n    '</head>',\n    '<body>',\n  ].join('\\n');\n};\n\n// Template function for rendering the boilerplate html for browsers\nexport const closeTemplate = ({\n  meteorRuntimeConfig,\n  meteorRuntimeHash,\n  rootUrlPathPrefix,\n  inlineScriptsAllowed,\n  js,\n  additionalStaticJs,\n  bundledJsCssUrlRewriteHook,\n  sriMode,\n}) => [\n  '',\n  inlineScriptsAllowed\n    ? template('  <script type=\"text/javascript\">__meteor_runtime_config__ = JSON.parse(decodeURIComponent(<%= conf %>))</script>')({\n      conf: meteorRuntimeConfig,\n    })\n    : template('  <script type=\"text/javascript\" src=\"<%- src %>/meteor_runtime_config.js?hash=<%- hash %>\"></script>')({\n      src: rootUrlPathPrefix,\n      hash: meteorRuntimeHash,\n    }),\n  '',\n\n  ...(js || []).map(file =>\n    template('  <script type=\"text/javascript\" src=\"<%- src %>\"<%= sri %>></script>')({\n      src: bundledJsCssUrlRewriteHook(file.url),\n      sri: sri(file.sri, sriMode),\n    })\n  ),\n\n  ...(additionalStaticJs || []).map(({ contents, pathname }) => (\n    inlineScriptsAllowed\n      ? template('  <script><%= contents %></script>')({\n        contents,\n      })\n      : template('  <script type=\"text/javascript\" src=\"<%- src %>\"></script>')({\n        src: rootUrlPathPrefix + pathname,\n      })\n  )),\n\n  '',\n  '',\n  '</body>',\n  '</html>'\n].join('\\n');\n","import template from './template';\n\n// Template function for rendering the boilerplate html for cordova\nexport const headTemplate = ({\n  meteorRuntimeConfig,\n  rootUrlPathPrefix,\n  inlineScriptsAllowed,\n  css,\n  js,\n  additionalStaticJs,\n  htmlAttributes,\n  bundledJsCssUrlRewriteHook,\n  head,\n  dynamicHead,\n}) => {\n  var headSections = head.split(/<meteor-bundled-css[^<>]*>/, 2);\n  var cssBundle = [\n    // We are explicitly not using bundledJsCssUrlRewriteHook: in cordova we serve assets up directly from disk, so rewriting the URL does not make sense\n    ...(css || []).map(file =>\n      template('  <link rel=\"stylesheet\" type=\"text/css\" class=\"__meteor-css__\" href=\"<%- href %>\">')({\n        href: file.url,\n      })\n  )].join('\\n');\n\n  return [\n    '<html>',\n    '<head>',\n    '  <meta charset=\"utf-8\">',\n    '  <meta name=\"format-detection\" content=\"telephone=no\">',\n    '  <meta name=\"viewport\" content=\"user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, viewport-fit=cover\">',\n    '  <meta name=\"msapplication-tap-highlight\" content=\"no\">',\n    '  <meta http-equiv=\"Content-Security-Policy\" content=\"default-src * android-webview-video-poster: gap: data: blob: \\'unsafe-inline\\' \\'unsafe-eval\\' ws: wss:;\">',\n\n  (headSections.length === 1)\n    ? [cssBundle, headSections[0]].join('\\n')\n    : [headSections[0], cssBundle, headSections[1]].join('\\n'),\n\n    '  <script type=\"text/javascript\">',\n    template('    __meteor_runtime_config__ = JSON.parse(decodeURIComponent(<%= conf %>));')({\n      conf: meteorRuntimeConfig,\n    }),\n    '    if (/Android/i.test(navigator.userAgent)) {',\n    // When Android app is emulated, it cannot connect to localhost,\n    // instead it should connect to 10.0.2.2\n    // (unless we\\'re using an http proxy; then it works!)\n    '      if (!__meteor_runtime_config__.httpProxyPort) {',\n    '        __meteor_runtime_config__.ROOT_URL = (__meteor_runtime_config__.ROOT_URL || \\'\\').replace(/localhost/i, \\'10.0.2.2\\');',\n    '        __meteor_runtime_config__.DDP_DEFAULT_CONNECTION_URL = (__meteor_runtime_config__.DDP_DEFAULT_CONNECTION_URL || \\'\\').replace(/localhost/i, \\'10.0.2.2\\');',\n    '      }',\n    '    }',\n    '  </script>',\n    '',\n    '  <script type=\"text/javascript\" src=\"/cordova.js\"></script>',\n\n    ...(js || []).map(file =>\n      template('  <script type=\"text/javascript\" src=\"<%- src %>\"></script>')({\n        src: file.url,\n      })\n    ),\n\n    ...(additionalStaticJs || []).map(({ contents, pathname }) => (\n      inlineScriptsAllowed\n        ? template('  <script><%= contents %></script>')({\n          contents,\n        })\n        : template('  <script type=\"text/javascript\" src=\"<%- src %>\"></script>')({\n          src: rootUrlPathPrefix + pathname\n        })\n    )),\n    '',\n    '</head>',\n    '',\n    '<body>',\n  ].join('\\n');\n};\n\nexport function closeTemplate() {\n  return \"</body>\\n</html>\";\n}\n","import lodashTemplate from 'lodash.template';\n\n// As identified in issue #9149, when an application overrides the default\n// _.template settings using _.templateSettings, those new settings are\n// used anywhere _.template is used, including within the\n// boilerplate-generator. To handle this, _.template settings that have\n// been verified to work are overridden here on each _.template call.\nexport default function template(text) {\n  return lodashTemplate(text, null, {\n    evaluate    : /<%([\\s\\S]+?)%>/g,\n    interpolate : /<%=([\\s\\S]+?)%>/g,\n    escape      : /<%-([\\s\\S]+?)%>/g,\n  });\n};"]}}]