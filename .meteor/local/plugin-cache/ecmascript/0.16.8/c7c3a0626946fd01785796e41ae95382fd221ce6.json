{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/nicholas/Desktop/projects/local-legends/client/styles/packages/mdg:meteor-apm-agent/lib/kadira.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","objectRestSpread","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.osx.x86_64"},"sourceFileName":"packages/mdg:meteor-apm-agent/lib/kadira.js","filename":"/Users/nicholas/Desktop/projects/local-legends/client/styles/packages/mdg:meteor-apm-agent/lib/kadira.js","targets":{},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/nicholas/Desktop/projects/local-legends/client/styles","root":"/Users/nicholas/Desktop/projects/local-legends/client/styles","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/nicholas/Desktop/projects/local-legends/client/styles/packages/mdg:meteor-apm-agent/lib/kadira.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"packages/mdg:meteor-apm-agent/lib/kadira.js"}},"code":"var hostname = Npm.require('os').hostname();\nvar logger = Npm.require('debug')('kadira:apm');\nvar Fibers = Npm.require('fibers');\nvar KadiraCore = Npm.require('kadira-core').Kadira;\nKadira.models = {};\nKadira.options = {};\nKadira.env = {\n  currentSub: null,\n  // keep current subscription inside ddp\n  kadiraInfo: new Meteor.EnvironmentVariable()\n};\nKadira.waitTimeBuilder = new WaitTimeBuilder();\nKadira.errors = [];\nKadira.errors.addFilter = Kadira.errors.push.bind(Kadira.errors);\nKadira.models.methods = new MethodsModel();\nKadira.models.pubsub = new PubsubModel();\nKadira.models.system = new SystemModel();\nKadira.docSzCache = new DocSzCache(100000, 10);\nKadira.connect = function (appId, appSecret, options) {\n  options = options || {};\n  options.appId = appId;\n  options.appSecret = appSecret;\n  options.payloadTimeout = options.payloadTimeout || 1000 * 20;\n  options.endpoint = options.endpoint || \"https://enginex.kadira.io\";\n  options.clientEngineSyncDelay = options.clientEngineSyncDelay || 10000;\n  options.thresholds = options.thresholds || {};\n  options.isHostNameSet = !!options.hostname;\n  options.hostname = options.hostname || hostname;\n  options.proxy = options.proxy || null;\n  if (options.documentSizeCacheSize) {\n    Kadira.docSzCache = new DocSzCache(options.documentSizeCacheSize, 10);\n  }\n\n  // remove trailing slash from endpoint url (if any)\n  if (_.last(options.endpoint) === '/') {\n    options.endpoint = options.endpoint.substr(0, options.endpoint.length - 1);\n  }\n\n  // error tracking is enabled by default\n  if (options.enableErrorTracking === undefined) {\n    options.enableErrorTracking = true;\n  }\n  Kadira.options = options;\n  Kadira.options.authHeaders = {\n    'KADIRA-APP-ID': Kadira.options.appId,\n    'KADIRA-APP-SECRET': Kadira.options.appSecret\n  };\n  Kadira.syncedDate = new Ntp(options.endpoint);\n  Kadira.syncedDate.sync();\n  Kadira.models.error = new ErrorModel(appId);\n\n  // handle pre-added filters\n  var addFilterFn = Kadira.models.error.addFilter.bind(Kadira.models.error);\n  Kadira.errors.forEach(addFilterFn);\n  Kadira.errors = Kadira.models.error;\n\n  // setting runtime info, which will be sent to kadira\n  __meteor_runtime_config__.kadira = {\n    appId: appId,\n    endpoint: options.endpoint,\n    clientEngineSyncDelay: options.clientEngineSyncDelay\n  };\n  if (options.enableErrorTracking) {\n    Kadira.enableErrorTracking();\n  } else {\n    Kadira.disableErrorTracking();\n  }\n  if (appId && appSecret) {\n    options.appId = options.appId.trim();\n    options.appSecret = options.appSecret.trim();\n    Kadira.coreApi = new KadiraCore({\n      appId: options.appId,\n      appSecret: options.appSecret,\n      endpoint: options.endpoint,\n      hostname: options.hostname\n    });\n    Kadira.coreApi._checkAuth().then(function () {\n      logger('connected to app: ', appId);\n      console.log('Meteor APM: Successfully connected');\n      Kadira._sendAppStats();\n      Kadira._schedulePayloadSend();\n    }).catch(function (err) {\n      console.log('Meteor APM: authentication failed - check your appId & appSecret');\n    });\n  } else {\n    throw new Error('Meteor APM: required appId and appSecret');\n  }\n\n  // start tracking errors\n  Meteor.startup(function () {\n    TrackUncaughtExceptions();\n    TrackMeteorDebug();\n  });\n  Meteor.publish(null, function () {\n    var options = __meteor_runtime_config__.kadira;\n    this.added('kadira_settings', Random.id(), options);\n    this.ready();\n  });\n\n  // notify we've connected\n  Kadira.connected = true;\n};\n\n//track how many times we've sent the data (once per minute)\nKadira._buildPayload = function () {\n  var payload = {\n    host: Kadira.options.hostname\n  };\n  var buildDetailedInfo = Kadira._isDetailedInfo();\n  Object.assign(payload, Kadira.models.methods.buildPayload(buildDetailedInfo));\n  Object.assign(payload, Kadira.models.pubsub.buildPayload(buildDetailedInfo));\n  Object.assign(payload, Kadira.models.system.buildPayload());\n  if (Kadira.options.enableErrorTracking) {\n    Object.assign(payload, Kadira.models.error.buildPayload());\n  }\n  return payload;\n};\nKadira._countDataSent = 0;\nKadira._detailInfoSentInterval = Math.ceil(1000 * 60 / Kadira.options.payloadTimeout);\nKadira._isDetailedInfo = function () {\n  return Kadira._countDataSent++ % Kadira._detailInfoSentInterval == 0;\n};\nKadira._sendAppStats = function () {\n  var appStats = {};\n  appStats.release = Meteor.release;\n  appStats.protocolVersion = '1.0.0';\n  appStats.packageVersions = [];\n  appStats.appVersions = {\n    webapp: __meteor_runtime_config__['autoupdateVersion'],\n    refreshable: __meteor_runtime_config__['autoupdateVersionRefreshable'],\n    cordova: __meteor_runtime_config__['autoupdateVersionCordova']\n  };\n\n  // TODO get version number for installed packages\n  _.each(Package, function (v, name) {\n    appStats.packageVersions.push({\n      name: name,\n      version: null\n    });\n  });\n  Kadira.coreApi.sendData({\n    startTime: new Date(),\n    appStats: appStats\n  }).catch(function (err) {\n    console.error('Kadira Error on sending appStats:', err.message);\n  });\n};\nKadira._schedulePayloadSend = function () {\n  setTimeout(function () {\n    Kadira._sendPayload(Kadira._schedulePayloadSend);\n  }, Kadira.options.payloadTimeout);\n};\nKadira._sendPayload = function (callback) {\n  new Fibers(function () {\n    var payload = Kadira._buildPayload();\n    Kadira.coreApi.sendData(payload).then(callback).catch(function (err) {\n      console.log('Meteor APM Error:', err.message);\n      callback();\n    });\n  }).run();\n};\n\n// this return the __kadiraInfo from the current Fiber by default\n// if called with 2nd argument as true, it will get the kadira info from\n// Meteor.EnvironmentVariable\n//\n// WARNING: returned info object is the reference object.\n//  Changing it might cause issues when building traces. So use with care\nKadira._getInfo = function (currentFiber, useEnvironmentVariable) {\n  currentFiber = currentFiber || Fibers.current;\n  if (currentFiber) {\n    if (useEnvironmentVariable) {\n      return Kadira.env.kadiraInfo.get();\n    }\n    return currentFiber.__kadiraInfo;\n  }\n};\n\n// this does not clone the info object. So, use with care\nKadira._setInfo = function (info) {\n  Fibers.current.__kadiraInfo = info;\n};\nKadira.enableErrorTracking = function () {\n  __meteor_runtime_config__.kadira.enableErrorTracking = true;\n  Kadira.options.enableErrorTracking = true;\n};\nKadira.disableErrorTracking = function () {\n  __meteor_runtime_config__.kadira.enableErrorTracking = false;\n  Kadira.options.enableErrorTracking = false;\n};\nKadira.trackError = function (type, message, options) {\n  if (Kadira.options.enableErrorTracking && type && message) {\n    options = options || {};\n    options.subType = options.subType || 'server';\n    options.stacks = options.stacks || '';\n    var error = {\n      message: message,\n      stack: options.stacks\n    };\n    var trace = {\n      type: type,\n      subType: options.subType,\n      name: message,\n      errored: true,\n      at: Kadira.syncedDate.getTime(),\n      events: [['start', 0, {}], ['error', 0, {\n        error: error\n      }]],\n      metrics: {\n        total: 0\n      }\n    };\n    Kadira.models.error.trackError(error, trace);\n  }\n};\nKadira.ignoreErrorTracking = function (err) {\n  err._skipKadira = true;\n};","map":{"version":3,"names":["hostname","Npm","require","logger","Fibers","KadiraCore","Kadira","models","options","env","currentSub","kadiraInfo","Meteor","EnvironmentVariable","waitTimeBuilder","WaitTimeBuilder","errors","addFilter","push","bind","methods","MethodsModel","pubsub","PubsubModel","system","SystemModel","docSzCache","DocSzCache","connect","appId","appSecret","payloadTimeout","endpoint","clientEngineSyncDelay","thresholds","isHostNameSet","proxy","documentSizeCacheSize","_","last","substr","length","enableErrorTracking","undefined","authHeaders","syncedDate","Ntp","sync","error","ErrorModel","addFilterFn","forEach","__meteor_runtime_config__","kadira","disableErrorTracking","trim","coreApi","_checkAuth","then","console","log","_sendAppStats","_schedulePayloadSend","catch","err","Error","startup","TrackUncaughtExceptions","TrackMeteorDebug","publish","added","Random","id","ready","connected","_buildPayload","payload","host","buildDetailedInfo","_isDetailedInfo","Object","assign","buildPayload","_countDataSent","_detailInfoSentInterval","Math","ceil","appStats","release","protocolVersion","packageVersions","appVersions","webapp","refreshable","cordova","each","Package","v","name","version","sendData","startTime","Date","message","setTimeout","_sendPayload","callback","run","_getInfo","currentFiber","useEnvironmentVariable","current","get","__kadiraInfo","_setInfo","info","trackError","type","subType","stacks","stack","trace","errored","at","getTime","events","metrics","total","ignoreErrorTracking","_skipKadira"],"sources":["packages/mdg:meteor-apm-agent/lib/kadira.js"],"sourcesContent":["var hostname = Npm.require('os').hostname();\nvar logger = Npm.require('debug')('kadira:apm');\nvar Fibers = Npm.require('fibers');\n\nvar KadiraCore = Npm.require('kadira-core').Kadira;\n\nKadira.models = {};\nKadira.options = {};\nKadira.env = {\n  currentSub: null, // keep current subscription inside ddp\n  kadiraInfo: new Meteor.EnvironmentVariable(),\n};\nKadira.waitTimeBuilder = new WaitTimeBuilder();\nKadira.errors = [];\nKadira.errors.addFilter = Kadira.errors.push.bind(Kadira.errors);\n\nKadira.models.methods = new MethodsModel();\nKadira.models.pubsub = new PubsubModel();\nKadira.models.system = new SystemModel();\nKadira.docSzCache = new DocSzCache(100000, 10);\n\n\nKadira.connect = function(appId, appSecret, options) {\n  options = options || {};\n  options.appId = appId;\n  options.appSecret = appSecret;\n  options.payloadTimeout = options.payloadTimeout || 1000 * 20;\n  options.endpoint = options.endpoint || \"https://enginex.kadira.io\";\n  options.clientEngineSyncDelay = options.clientEngineSyncDelay || 10000;\n  options.thresholds = options.thresholds || {};\n  options.isHostNameSet = !!options.hostname;\n  options.hostname = options.hostname || hostname;\n  options.proxy = options.proxy || null;\n\n  if(options.documentSizeCacheSize) {\n    Kadira.docSzCache = new DocSzCache(options.documentSizeCacheSize, 10);\n  }\n\n  // remove trailing slash from endpoint url (if any)\n  if(_.last(options.endpoint) === '/') {\n    options.endpoint = options.endpoint.substr(0, options.endpoint.length - 1);\n  }\n\n  // error tracking is enabled by default\n  if(options.enableErrorTracking === undefined) {\n    options.enableErrorTracking = true;\n  }\n\n  Kadira.options = options;\n  Kadira.options.authHeaders = {\n    'KADIRA-APP-ID': Kadira.options.appId,\n    'KADIRA-APP-SECRET': Kadira.options.appSecret\n  };\n\n  Kadira.syncedDate = new Ntp(options.endpoint);\n  Kadira.syncedDate.sync();\n  Kadira.models.error = new ErrorModel(appId);\n\n  // handle pre-added filters\n  var addFilterFn = Kadira.models.error.addFilter.bind(Kadira.models.error);\n  Kadira.errors.forEach(addFilterFn);\n  Kadira.errors = Kadira.models.error;\n\n  // setting runtime info, which will be sent to kadira\n  __meteor_runtime_config__.kadira = {\n    appId: appId,\n    endpoint: options.endpoint,\n    clientEngineSyncDelay: options.clientEngineSyncDelay,\n  };\n\n  if(options.enableErrorTracking) {\n    Kadira.enableErrorTracking();\n  } else {\n    Kadira.disableErrorTracking();\n  }\n\n  if(appId && appSecret) {\n    options.appId = options.appId.trim();\n    options.appSecret = options.appSecret.trim();\n\n    Kadira.coreApi = new KadiraCore({\n      appId: options.appId,\n      appSecret: options.appSecret,\n      endpoint: options.endpoint,\n      hostname: options.hostname\n    });\n\n    Kadira.coreApi._checkAuth()\n      .then(function() {\n        logger('connected to app: ', appId);\n        console.log('Meteor APM: Successfully connected');\n        Kadira._sendAppStats();\n        Kadira._schedulePayloadSend();\n      })\n      .catch(function(err) {\n        console.log('Meteor APM: authentication failed - check your appId & appSecret')\n      });\n  } else {\n    throw new Error('Meteor APM: required appId and appSecret');\n  }\n\n  // start tracking errors\n  Meteor.startup(function () {\n    TrackUncaughtExceptions();\n    TrackMeteorDebug();\n  })\n\n  Meteor.publish(null, function () {\n    var options = __meteor_runtime_config__.kadira;\n    this.added('kadira_settings', Random.id(), options);\n    this.ready();\n  });\n\n  // notify we've connected\n  Kadira.connected = true;\n};\n\n//track how many times we've sent the data (once per minute)\nKadira._buildPayload = function () {\n  var payload = {host: Kadira.options.hostname};\n  var buildDetailedInfo = Kadira._isDetailedInfo();\n  Object.assign(payload, Kadira.models.methods.buildPayload(buildDetailedInfo));\n  Object.assign(payload, Kadira.models.pubsub.buildPayload(buildDetailedInfo));\n  Object.assign(payload, Kadira.models.system.buildPayload());\n  if(Kadira.options.enableErrorTracking) {\n    Object.assign(payload, Kadira.models.error.buildPayload());\n  }\n\n  return payload;\n}\n\nKadira._countDataSent = 0;\nKadira._detailInfoSentInterval = Math.ceil((1000*60) / Kadira.options.payloadTimeout);\nKadira._isDetailedInfo = function () {\n  return (Kadira._countDataSent++ % Kadira._detailInfoSentInterval) == 0;\n}\n\nKadira._sendAppStats = function () {\n  var appStats = {};\n  appStats.release = Meteor.release;\n  appStats.protocolVersion = '1.0.0';\n  appStats.packageVersions = [];\n  appStats.appVersions = {\n    webapp: __meteor_runtime_config__['autoupdateVersion'],\n    refreshable: __meteor_runtime_config__['autoupdateVersionRefreshable'],\n    cordova: __meteor_runtime_config__['autoupdateVersionCordova']\n  }\n\n  // TODO get version number for installed packages\n  _.each(Package, function (v, name) {\n    appStats.packageVersions.push({name: name, version: null});\n  });\n\n  Kadira.coreApi.sendData({\n    startTime: new Date(),\n    appStats: appStats\n  }).catch(function(err) {\n    console.error('Kadira Error on sending appStats:', err.message);\n  });\n}\n\nKadira._schedulePayloadSend = function () {\n  setTimeout(function () {\n    Kadira._sendPayload(Kadira._schedulePayloadSend);\n  }, Kadira.options.payloadTimeout);\n}\n\nKadira._sendPayload = function (callback) {\n  new Fibers(function() {\n    var payload = Kadira._buildPayload();\n    Kadira.coreApi.sendData(payload)\n    .then(callback)\n    .catch(function(err) {\n      console.log('Meteor APM Error:', err.message);\n      callback();\n    });\n  }).run();\n}\n\n// this return the __kadiraInfo from the current Fiber by default\n// if called with 2nd argument as true, it will get the kadira info from\n// Meteor.EnvironmentVariable\n//\n// WARNING: returned info object is the reference object.\n//  Changing it might cause issues when building traces. So use with care\nKadira._getInfo = function(currentFiber, useEnvironmentVariable) {\n  currentFiber = currentFiber || Fibers.current;\n  if(currentFiber) {\n    if(useEnvironmentVariable) {\n      return Kadira.env.kadiraInfo.get();\n    }\n    return currentFiber.__kadiraInfo;\n  }\n};\n\n// this does not clone the info object. So, use with care\nKadira._setInfo = function(info) {\n  Fibers.current.__kadiraInfo = info;\n};\n\nKadira.enableErrorTracking = function () {\n  __meteor_runtime_config__.kadira.enableErrorTracking = true;\n  Kadira.options.enableErrorTracking = true;\n};\n\nKadira.disableErrorTracking = function () {\n  __meteor_runtime_config__.kadira.enableErrorTracking = false;\n  Kadira.options.enableErrorTracking = false;\n};\n\nKadira.trackError = function (type, message, options) {\n  if(Kadira.options.enableErrorTracking && type && message) {\n    options = options || {};\n    options.subType = options.subType || 'server';\n    options.stacks = options.stacks || '';\n    var error = {message: message, stack: options.stacks};\n    var trace = {\n      type: type,\n      subType: options.subType,\n      name: message,\n      errored: true,\n      at: Kadira.syncedDate.getTime(),\n      events: [['start', 0, {}], ['error', 0, {error: error}]],\n      metrics: {total: 0}\n    };\n    Kadira.models.error.trackError(error, trace);\n  }\n}\n\nKadira.ignoreErrorTracking = function (err) {\n  err._skipKadira = true;\n}\n"],"mappings":"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"},"sourceType":"module","externalDependencies":{},"hash":"c7c3a0626946fd01785796e41ae95382fd221ce6"}
