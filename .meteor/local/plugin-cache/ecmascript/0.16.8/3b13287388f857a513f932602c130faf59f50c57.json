{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/nicholas/Desktop/projects/local-legends/client/styles/packages/mdg:meteor-apm-agent/lib/tracer/tracer_store.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","objectRestSpread","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.osx.x86_64"},"sourceFileName":"packages/mdg:meteor-apm-agent/lib/tracer/tracer_store.js","filename":"/Users/nicholas/Desktop/projects/local-legends/client/styles/packages/mdg:meteor-apm-agent/lib/tracer/tracer_store.js","targets":{},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/nicholas/Desktop/projects/local-legends/client/styles","root":"/Users/nicholas/Desktop/projects/local-legends/client/styles","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/nicholas/Desktop/projects/local-legends/client/styles/packages/mdg:meteor-apm-agent/lib/tracer/tracer_store.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"packages/mdg:meteor-apm-agent/lib/tracer/tracer_store.js"}},"code":"var logger = Npm.require('debug')('kadira:ts');\nTracerStore = function TracerStore(options) {\n  options = options || {};\n  this.maxTotalPoints = options.maxTotalPoints || 30;\n  this.interval = options.interval || 1000 * 60;\n  this.archiveEvery = options.archiveEvery || this.maxTotalPoints / 6;\n\n  //store max total on the past 30 minutes (or past 30 items)\n  this.maxTotals = Object.create(null);\n  //store the max trace of the current interval\n  this.currentMaxTrace = Object.create(null);\n  //archive for the traces\n  this.traceArchive = [];\n  this.processedCnt = Object.create(null);\n\n  //group errors by messages between an interval\n  this.errorMap = Object.create(null);\n};\nTracerStore.prototype.addTrace = function (trace) {\n  var kind = [trace.type, trace.name].join('::');\n  if (!this.currentMaxTrace[kind]) {\n    this.currentMaxTrace[kind] = EJSON.clone(trace);\n  } else if (this.currentMaxTrace[kind].metrics.total < trace.metrics.total) {\n    this.currentMaxTrace[kind] = EJSON.clone(trace);\n  } else if (trace.errored) {\n    this._handleErrors(trace);\n  }\n};\nTracerStore.prototype.collectTraces = function () {\n  var traces = this.traceArchive;\n  this.traceArchive = [];\n\n  // convert at(timestamp) into the actual serverTime\n  traces.forEach(function (trace) {\n    trace.at = Kadira.syncedDate.syncTime(trace.at);\n  });\n  return traces;\n};\nTracerStore.prototype.start = function () {\n  this._timeoutHandler = setInterval(this.processTraces.bind(this), this.interval);\n};\nTracerStore.prototype.stop = function () {\n  if (this._timeoutHandler) {\n    clearInterval(this._timeoutHandler);\n  }\n};\nTracerStore.prototype._handleErrors = function (trace) {\n  // sending error requests as it is\n  var lastEvent = trace.events[trace.events.length - 1];\n  if (lastEvent && lastEvent[2]) {\n    var error = lastEvent[2].error;\n\n    // grouping errors occured (reset after processTraces)\n    var errorKey = [trace.type, trace.name, error.message].join(\"::\");\n    if (!this.errorMap[errorKey]) {\n      var erroredTrace = EJSON.clone(trace);\n      this.errorMap[errorKey] = erroredTrace;\n      this.traceArchive.push(erroredTrace);\n    }\n  } else {\n    logger('last events is not an error: ', JSON.stringify(trace.events));\n  }\n};\nTracerStore.prototype.processTraces = function () {\n  var self = this;\n  var kinds = _.union(_.keys(this.maxTotals), _.keys(this.currentMaxTrace));\n  kinds.forEach(function (kind) {\n    self.processedCnt[kind] = self.processedCnt[kind] || 0;\n    var currentMaxTrace = self.currentMaxTrace[kind];\n    var currentMaxTotal = currentMaxTrace ? currentMaxTrace.metrics.total : 0;\n    self.maxTotals[kind] = self.maxTotals[kind] || [];\n    //add the current maxPoint\n    self.maxTotals[kind].push(currentMaxTotal);\n    var exceedingPoints = self.maxTotals[kind].length - self.maxTotalPoints;\n    if (exceedingPoints > 0) {\n      self.maxTotals[kind].splice(0, exceedingPoints);\n    }\n    var archiveDefault = self.processedCnt[kind] % self.archiveEvery == 0;\n    self.processedCnt[kind]++;\n    var canArchive = archiveDefault || self._isTraceOutlier(kind, currentMaxTrace);\n    if (canArchive && currentMaxTrace) {\n      self.traceArchive.push(currentMaxTrace);\n    }\n\n    //reset currentMaxTrace\n    self.currentMaxTrace[kind] = null;\n  });\n\n  //reset the errorMap\n  self.errorMap = Object.create(null);\n};\nTracerStore.prototype._isTraceOutlier = function (kind, trace) {\n  if (trace) {\n    var dataSet = this.maxTotals[kind];\n    return this._isOutlier(dataSet, trace.metrics.total, 3);\n  } else {\n    return false;\n  }\n};\n\n/*\n  Data point must exists in the dataSet\n*/\nTracerStore.prototype._isOutlier = function (dataSet, dataPoint, maxMadZ) {\n  var median = this._getMedian(dataSet);\n  var mad = this._calculateMad(dataSet, median);\n  var madZ = this._funcMedianDeviation(median)(dataPoint) / mad;\n  return madZ > maxMadZ;\n};\nTracerStore.prototype._getMedian = function (dataSet) {\n  var sortedDataSet = _.clone(dataSet).sort(function (a, b) {\n    return a - b;\n  });\n  return this._pickQuartile(sortedDataSet, 2);\n};\nTracerStore.prototype._pickQuartile = function (dataSet, num) {\n  var pos = (dataSet.length + 1) * num / 4;\n  if (pos % 1 == 0) {\n    return dataSet[pos - 1];\n  } else {\n    pos = pos - pos % 1;\n    return (dataSet[pos - 1] + dataSet[pos]) / 2;\n  }\n};\nTracerStore.prototype._calculateMad = function (dataSet, median) {\n  var medianDeviations = _.map(dataSet, this._funcMedianDeviation(median));\n  var mad = this._getMedian(medianDeviations);\n  return mad;\n};\nTracerStore.prototype._funcMedianDeviation = function (median) {\n  return function (x) {\n    return Math.abs(median - x);\n  };\n};\nTracerStore.prototype._getMean = function (dataPoints) {\n  if (dataPoints.length > 0) {\n    var total = 0;\n    dataPoints.forEach(function (point) {\n      total += point;\n    });\n    return total / dataPoints.length;\n  } else {\n    return 0;\n  }\n};","map":{"version":3,"names":["logger","Npm","require","TracerStore","options","maxTotalPoints","interval","archiveEvery","maxTotals","Object","create","currentMaxTrace","traceArchive","processedCnt","errorMap","prototype","addTrace","trace","kind","type","name","join","EJSON","clone","metrics","total","errored","_handleErrors","collectTraces","traces","forEach","at","Kadira","syncedDate","syncTime","start","_timeoutHandler","setInterval","processTraces","bind","stop","clearInterval","lastEvent","events","length","error","errorKey","message","erroredTrace","push","JSON","stringify","self","kinds","_","union","keys","currentMaxTotal","exceedingPoints","splice","archiveDefault","canArchive","_isTraceOutlier","dataSet","_isOutlier","dataPoint","maxMadZ","median","_getMedian","mad","_calculateMad","madZ","_funcMedianDeviation","sortedDataSet","sort","a","b","_pickQuartile","num","pos","medianDeviations","map","x","Math","abs","_getMean","dataPoints","point"],"sources":["packages/mdg:meteor-apm-agent/lib/tracer/tracer_store.js"],"sourcesContent":["var logger = Npm.require('debug')('kadira:ts');\n\nTracerStore = function TracerStore(options) {\n  options = options || {};\n\n  this.maxTotalPoints = options.maxTotalPoints || 30;\n  this.interval = options.interval || 1000 * 60;\n  this.archiveEvery = options.archiveEvery || this.maxTotalPoints / 6;\n\n  //store max total on the past 30 minutes (or past 30 items)\n  this.maxTotals = Object.create(null);\n  //store the max trace of the current interval\n  this.currentMaxTrace = Object.create(null);\n  //archive for the traces\n  this.traceArchive = [];\n\n  this.processedCnt = Object.create(null);\n\n  //group errors by messages between an interval\n  this.errorMap = Object.create(null);\n};\n\nTracerStore.prototype.addTrace = function(trace) {\n  var kind = [trace.type, trace.name].join('::');\n  if(!this.currentMaxTrace[kind]) {\n    this.currentMaxTrace[kind] = EJSON.clone(trace);\n  } else if(this.currentMaxTrace[kind].metrics.total < trace.metrics.total) {\n    this.currentMaxTrace[kind] = EJSON.clone(trace);\n  } else if(trace.errored) {\n    this._handleErrors(trace);\n  }\n};\n\nTracerStore.prototype.collectTraces = function() {\n  var traces = this.traceArchive;\n  this.traceArchive = [];\n\n  // convert at(timestamp) into the actual serverTime\n  traces.forEach(function(trace) {\n    trace.at = Kadira.syncedDate.syncTime(trace.at);\n  });\n  return traces;\n};\n\nTracerStore.prototype.start = function() {\n  this._timeoutHandler = setInterval(this.processTraces.bind(this), this.interval);\n};\n\nTracerStore.prototype.stop = function() {\n  if(this._timeoutHandler) {\n    clearInterval(this._timeoutHandler);\n  }\n};\n\nTracerStore.prototype._handleErrors = function(trace) {\n  // sending error requests as it is\n  var lastEvent = trace.events[trace.events.length -1];\n  if(lastEvent && lastEvent[2]) {\n    var error = lastEvent[2].error;\n\n    // grouping errors occured (reset after processTraces)\n    var errorKey = [trace.type, trace.name, error.message].join(\"::\");\n    if(!this.errorMap[errorKey]) {\n      var erroredTrace = EJSON.clone(trace);\n      this.errorMap[errorKey] = erroredTrace;\n\n      this.traceArchive.push(erroredTrace);\n    }\n  } else {\n    logger('last events is not an error: ', JSON.stringify(trace.events));\n  }\n};\n\nTracerStore.prototype.processTraces = function() {\n  var self = this;\n  var kinds = _.union(\n    _.keys(this.maxTotals),\n    _.keys(this.currentMaxTrace)\n  );\n\n  kinds.forEach(function(kind) {\n    self.processedCnt[kind] = self.processedCnt[kind] || 0;\n    var currentMaxTrace = self.currentMaxTrace[kind];\n    var currentMaxTotal = currentMaxTrace? currentMaxTrace.metrics.total : 0;\n\n    self.maxTotals[kind] = self.maxTotals[kind] || [];\n    //add the current maxPoint\n    self.maxTotals[kind].push(currentMaxTotal);\n    var exceedingPoints = self.maxTotals[kind].length - self.maxTotalPoints;\n    if(exceedingPoints > 0) {\n      self.maxTotals[kind].splice(0, exceedingPoints);\n    }\n\n    var archiveDefault = (self.processedCnt[kind] % self.archiveEvery) == 0;\n    self.processedCnt[kind]++;\n\n    var canArchive = archiveDefault\n      || self._isTraceOutlier(kind, currentMaxTrace);\n\n    if(canArchive && currentMaxTrace) {\n      self.traceArchive.push(currentMaxTrace);\n    }\n\n    //reset currentMaxTrace\n    self.currentMaxTrace[kind] = null;\n  });\n\n  //reset the errorMap\n  self.errorMap = Object.create(null);\n};\n\nTracerStore.prototype._isTraceOutlier = function(kind, trace) {\n  if(trace) {\n    var dataSet = this.maxTotals[kind];\n    return this._isOutlier(dataSet, trace.metrics.total, 3);\n  } else {\n    return false;\n  }\n};\n\n/*\n  Data point must exists in the dataSet\n*/\nTracerStore.prototype._isOutlier = function(dataSet, dataPoint, maxMadZ) {\n  var median = this._getMedian(dataSet);\n  var mad = this._calculateMad(dataSet, median);\n  var madZ = this._funcMedianDeviation(median)(dataPoint) / mad;\n\n  return madZ > maxMadZ;\n};\n\nTracerStore.prototype._getMedian = function(dataSet) {\n  var sortedDataSet = _.clone(dataSet).sort(function(a, b) {\n    return a-b;\n  });\n  return this._pickQuartile(sortedDataSet, 2);\n};\n\nTracerStore.prototype._pickQuartile = function(dataSet, num) {\n  var pos = ((dataSet.length + 1) * num) / 4;\n  if(pos % 1 == 0) {\n    return dataSet[pos -1];\n  } else {\n    pos = pos - (pos % 1);\n    return (dataSet[pos -1] + dataSet[pos])/2\n  }\n};\n\nTracerStore.prototype._calculateMad = function(dataSet, median) {\n  var medianDeviations = _.map(dataSet, this._funcMedianDeviation(median));\n  var mad = this._getMedian(medianDeviations);\n\n  return mad;\n};\n\nTracerStore.prototype._funcMedianDeviation = function(median) {\n  return function(x) {\n    return Math.abs(median - x);\n  };\n};\n\nTracerStore.prototype._getMean = function(dataPoints) {\n  if(dataPoints.length > 0) {\n    var total = 0;\n    dataPoints.forEach(function(point) {\n      total += point;\n    });\n    return total/dataPoints.length;\n  } else {\n    return 0;\n  }\n};\n"],"mappings":"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"},"sourceType":"module","externalDependencies":{},"hash":"3b13287388f857a513f932602c130faf59f50c57"}
