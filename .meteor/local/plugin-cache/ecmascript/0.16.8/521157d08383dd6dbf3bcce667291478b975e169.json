{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/nicholas/Desktop/projects/local-legends/client/styles/packages/mdg:meteor-apm-agent/lib/tracer/tracer.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","objectRestSpread","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.osx.x86_64"},"sourceFileName":"packages/mdg:meteor-apm-agent/lib/tracer/tracer.js","filename":"/Users/nicholas/Desktop/projects/local-legends/client/styles/packages/mdg:meteor-apm-agent/lib/tracer/tracer.js","targets":{},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/nicholas/Desktop/projects/local-legends/client/styles","root":"/Users/nicholas/Desktop/projects/local-legends/client/styles","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/nicholas/Desktop/projects/local-legends/client/styles/packages/mdg:meteor-apm-agent/lib/tracer/tracer.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"packages/mdg:meteor-apm-agent/lib/tracer/tracer.js"}},"code":"var Fibers = Npm.require('fibers');\nvar eventLogger = Npm.require('debug')('kadira:tracer');\nvar REPITITIVE_EVENTS = {\n  'db': true,\n  'http': true,\n  'email': true,\n  'wait': true,\n  'async': true\n};\nTracer = function Tracer() {\n  this._filters = [];\n};\n\n//In the future, we might wan't to track inner fiber events too.\n//Then we can't serialize the object with methods\n//That's why we use this method of returning the data\nTracer.prototype.start = function (session, msg) {\n  var traceInfo = {\n    _id: session.id + \"::\" + msg.id,\n    session: session.id,\n    userId: session.userId,\n    id: msg.id,\n    events: []\n  };\n  if (msg.msg == 'method') {\n    traceInfo.type = 'method';\n    traceInfo.name = msg.method;\n  } else if (msg.msg == 'sub') {\n    traceInfo.type = 'sub';\n    traceInfo.name = msg.name;\n  } else {\n    return null;\n  }\n  return traceInfo;\n};\nTracer.prototype.event = function (traceInfo, type, data) {\n  // do not allow to proceed, if already completed or errored\n  var lastEvent = this.getLastEvent(traceInfo);\n  if (lastEvent && ['complete', 'error'].indexOf(lastEvent.type) >= 0) {\n    return false;\n  }\n\n  //expecting a end event\n  var eventId = true;\n\n  //specially handling for repitivive events like db, http\n  if (REPITITIVE_EVENTS[type]) {\n    //can't accept a new start event\n    if (traceInfo._lastEventId) {\n      return false;\n    }\n    eventId = traceInfo._lastEventId = DefaultUniqueId.get();\n  }\n  var event = {\n    type: type,\n    at: Ntp._now()\n  };\n  if (data) {\n    var info = _.pick(traceInfo, 'type', 'name');\n    event.data = this._applyFilters(type, data, info, \"start\");\n    ;\n  }\n  traceInfo.events.push(event);\n  eventLogger(\"%s %s\", type, traceInfo._id);\n  return eventId;\n};\nTracer.prototype.eventEnd = function (traceInfo, eventId, data) {\n  if (traceInfo._lastEventId && traceInfo._lastEventId == eventId) {\n    var lastEvent = this.getLastEvent(traceInfo);\n    var type = lastEvent.type + 'end';\n    var event = {\n      type: type,\n      at: Ntp._now()\n    };\n    if (data) {\n      var info = _.pick(traceInfo, 'type', 'name');\n      event.data = this._applyFilters(type, data, info, \"end\");\n      ;\n    }\n    traceInfo.events.push(event);\n    eventLogger(\"%s %s\", type, traceInfo._id);\n    traceInfo._lastEventId = null;\n    return true;\n  } else {\n    return false;\n  }\n};\nTracer.prototype.getLastEvent = function (traceInfo) {\n  return traceInfo.events[traceInfo.events.length - 1];\n};\nTracer.prototype.endLastEvent = function (traceInfo) {\n  var lastEvent = this.getLastEvent(traceInfo);\n  if (lastEvent && !/end$/.test(lastEvent.type)) {\n    traceInfo.events.push({\n      type: lastEvent.type + 'end',\n      at: Ntp._now()\n    });\n    return true;\n  }\n  return false;\n};\nTracer.prototype.buildTrace = function (traceInfo) {\n  var firstEvent = traceInfo.events[0];\n  var lastEvent = traceInfo.events[traceInfo.events.length - 1];\n  var processedEvents = [];\n  if (firstEvent.type != 'start') {\n    console.warn('Kadira: trace is not started yet');\n    return null;\n  } else if (lastEvent.type != 'complete' && lastEvent.type != 'error') {\n    //trace is not completed or errored yet\n    console.warn('Kadira: trace is not completed or errored yet');\n    return null;\n  } else {\n    //build the metrics\n    traceInfo.errored = lastEvent.type == 'error';\n    traceInfo.at = firstEvent.at;\n    var metrics = {\n      total: lastEvent.at - firstEvent.at\n    };\n    var totalNonCompute = 0;\n    firstEvent = ['start', 0];\n    if (traceInfo.events[0].data) firstEvent.push(traceInfo.events[0].data);\n    processedEvents.push(firstEvent);\n    for (var lc = 1; lc < traceInfo.events.length - 1; lc += 2) {\n      var prevEventEnd = traceInfo.events[lc - 1];\n      var startEvent = traceInfo.events[lc];\n      var endEvent = traceInfo.events[lc + 1];\n      var computeTime = startEvent.at - prevEventEnd.at;\n      if (computeTime > 0) processedEvents.push(['compute', computeTime]);\n      if (!endEvent) {\n        console.error('Kadira: no end event for type: ', startEvent.type);\n        return null;\n      } else if (endEvent.type != startEvent.type + 'end') {\n        console.error('Kadira: endevent type mismatch: ', startEvent.type, endEvent.type, JSON.stringify(traceInfo));\n        return null;\n      } else {\n        var elapsedTimeForEvent = endEvent.at - startEvent.at;\n        var currentEvent = [startEvent.type, elapsedTimeForEvent];\n        currentEvent.push(Object.assign({}, startEvent.data, endEvent.data));\n        processedEvents.push(currentEvent);\n        metrics[startEvent.type] = metrics[startEvent.type] || 0;\n        metrics[startEvent.type] += elapsedTimeForEvent;\n        totalNonCompute += elapsedTimeForEvent;\n      }\n    }\n    computeTime = lastEvent.at - traceInfo.events[traceInfo.events.length - 2];\n    if (computeTime > 0) processedEvents.push(['compute', computeTime]);\n    var lastEventData = [lastEvent.type, 0];\n    if (lastEvent.data) lastEventData.push(lastEvent.data);\n    processedEvents.push(lastEventData);\n    metrics.compute = metrics.total - totalNonCompute;\n    traceInfo.metrics = metrics;\n    traceInfo.events = processedEvents;\n    traceInfo.isEventsProcessed = true;\n    return traceInfo;\n  }\n};\nTracer.prototype.addFilter = function (filterFn) {\n  this._filters.push(filterFn);\n};\nTracer.prototype._applyFilters = function (eventType, data, info) {\n  this._filters.forEach(function (filterFn) {\n    data = filterFn(eventType, _.clone(data), info);\n  });\n  return data;\n};\nKadira.tracer = new Tracer();\n// need to expose Tracer to provide default set of filters\nKadira.Tracer = Tracer;","map":{"version":3,"names":["Fibers","Npm","require","eventLogger","REPITITIVE_EVENTS","Tracer","_filters","prototype","start","session","msg","traceInfo","_id","id","userId","events","type","name","method","event","data","lastEvent","getLastEvent","indexOf","eventId","_lastEventId","DefaultUniqueId","get","at","Ntp","_now","info","_","pick","_applyFilters","push","eventEnd","length","endLastEvent","test","buildTrace","firstEvent","processedEvents","console","warn","errored","metrics","total","totalNonCompute","lc","prevEventEnd","startEvent","endEvent","computeTime","error","JSON","stringify","elapsedTimeForEvent","currentEvent","Object","assign","lastEventData","compute","isEventsProcessed","addFilter","filterFn","eventType","forEach","clone","Kadira","tracer"],"sources":["packages/mdg:meteor-apm-agent/lib/tracer/tracer.js"],"sourcesContent":["var Fibers = Npm.require('fibers');\nvar eventLogger = Npm.require('debug')('kadira:tracer');\nvar REPITITIVE_EVENTS = {'db': true, 'http': true, 'email': true, 'wait': true, 'async': true};\n\nTracer = function Tracer() {\n  this._filters = [];\n};\n\n//In the future, we might wan't to track inner fiber events too.\n//Then we can't serialize the object with methods\n//That's why we use this method of returning the data\nTracer.prototype.start = function(session, msg) {\n  var traceInfo = {\n    _id: session.id + \"::\" + msg.id,\n    session: session.id,\n    userId: session.userId,\n    id: msg.id,\n    events: []\n  };\n\n  if(msg.msg == 'method') {\n    traceInfo.type = 'method';\n    traceInfo.name = msg.method;\n  } else if(msg.msg == 'sub') {\n    traceInfo.type = 'sub';\n    traceInfo.name = msg.name;\n  } else {\n    return null;\n  }\n\n  return traceInfo;\n};\n\nTracer.prototype.event = function(traceInfo, type, data) {\n  // do not allow to proceed, if already completed or errored\n  var lastEvent = this.getLastEvent(traceInfo);\n  if(lastEvent && ['complete', 'error'].indexOf(lastEvent.type) >= 0) {\n    return false;\n  }\n\n  //expecting a end event\n  var eventId = true;\n\n  //specially handling for repitivive events like db, http\n  if(REPITITIVE_EVENTS[type]) {\n    //can't accept a new start event\n    if(traceInfo._lastEventId) {\n      return false;\n    }\n    eventId = traceInfo._lastEventId = DefaultUniqueId.get();\n  }\n\n  var event = {type: type, at: Ntp._now()};\n  if(data) {\n    var info = _.pick(traceInfo, 'type', 'name')\n    event.data = this._applyFilters(type, data, info, \"start\");;\n  }\n\n  traceInfo.events.push(event);\n\n  eventLogger(\"%s %s\", type, traceInfo._id);\n  return eventId;\n};\n\nTracer.prototype.eventEnd = function(traceInfo, eventId, data) {\n  if(traceInfo._lastEventId && traceInfo._lastEventId == eventId) {\n    var lastEvent = this.getLastEvent(traceInfo);\n    var type = lastEvent.type + 'end';\n    var event = {type: type, at: Ntp._now()};\n    if(data) {\n      var info = _.pick(traceInfo, 'type', 'name')\n      event.data = this._applyFilters(type, data, info, \"end\");;\n    }\n    traceInfo.events.push(event);\n    eventLogger(\"%s %s\", type, traceInfo._id);\n\n    traceInfo._lastEventId = null;\n    return true;\n  } else {\n    return false;\n  }\n};\n\nTracer.prototype.getLastEvent = function(traceInfo) {\n  return traceInfo.events[traceInfo.events.length -1]\n};\n\nTracer.prototype.endLastEvent = function(traceInfo) {\n  var lastEvent = this.getLastEvent(traceInfo);\n  if(lastEvent && !/end$/.test(lastEvent.type)) {\n    traceInfo.events.push({\n      type: lastEvent.type + 'end',\n      at: Ntp._now()\n    });\n    return true;\n  }\n  return false;\n};\n\nTracer.prototype.buildTrace = function(traceInfo) {\n  var firstEvent = traceInfo.events[0];\n  var lastEvent = traceInfo.events[traceInfo.events.length - 1];\n  var processedEvents = [];\n\n  if(firstEvent.type != 'start') {\n    console.warn('Kadira: trace is not started yet');\n    return null;\n  } else if(lastEvent.type != 'complete' && lastEvent.type != 'error') {\n    //trace is not completed or errored yet\n    console.warn('Kadira: trace is not completed or errored yet');\n    return null;\n  } else {\n    //build the metrics\n    traceInfo.errored = lastEvent.type == 'error';\n    traceInfo.at = firstEvent.at;\n\n    var metrics = {\n      total: lastEvent.at - firstEvent.at,\n    };\n\n    var totalNonCompute = 0;\n\n    firstEvent = ['start', 0];\n    if(traceInfo.events[0].data) firstEvent.push(traceInfo.events[0].data);\n    processedEvents.push(firstEvent);\n\n    for(var lc=1; lc < traceInfo.events.length - 1; lc += 2) {\n      var prevEventEnd = traceInfo.events[lc-1];\n      var startEvent = traceInfo.events[lc];\n      var endEvent = traceInfo.events[lc+1];\n      var computeTime = startEvent.at - prevEventEnd.at;\n      if(computeTime > 0) processedEvents.push(['compute', computeTime]);\n      if(!endEvent) {\n        console.error('Kadira: no end event for type: ', startEvent.type);\n        return null;\n      } else if(endEvent.type != startEvent.type + 'end') {\n        console.error('Kadira: endevent type mismatch: ', startEvent.type, endEvent.type, JSON.stringify(traceInfo));\n        return null;\n      } else {\n        var elapsedTimeForEvent = endEvent.at - startEvent.at\n        var currentEvent = [startEvent.type, elapsedTimeForEvent];\n        currentEvent.push(Object.assign({}, startEvent.data, endEvent.data));\n        processedEvents.push(currentEvent);\n        metrics[startEvent.type] = metrics[startEvent.type] || 0;\n        metrics[startEvent.type] += elapsedTimeForEvent;\n        totalNonCompute += elapsedTimeForEvent;\n      }\n    }\n\n    computeTime = lastEvent.at - traceInfo.events[traceInfo.events.length - 2];\n    if(computeTime > 0) processedEvents.push(['compute', computeTime]);\n\n    var lastEventData = [lastEvent.type, 0];\n    if(lastEvent.data) lastEventData.push(lastEvent.data);\n    processedEvents.push(lastEventData);\n\n    metrics.compute = metrics.total - totalNonCompute;\n    traceInfo.metrics = metrics;\n    traceInfo.events = processedEvents;\n    traceInfo.isEventsProcessed = true;\n    return traceInfo;\n  }\n};\n\nTracer.prototype.addFilter = function(filterFn) {\n  this._filters.push(filterFn);\n};\n\nTracer.prototype._applyFilters = function(eventType, data, info) {\n  this._filters.forEach(function(filterFn) {\n    data = filterFn(eventType, _.clone(data), info);\n  });\n\n  return data;\n};\n\nKadira.tracer = new Tracer();\n// need to expose Tracer to provide default set of filters\nKadira.Tracer = Tracer;"],"mappings":"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"},"sourceType":"module","externalDependencies":{},"hash":"521157d08383dd6dbf3bcce667291478b975e169"}
